10 REM PRODUCT-SUM NUMBERS
20 REM FIND MINIMAL PRODUCT-SUM FOR K=2 TO KL
30 KL = 100: REM START WITH 100, NOT 12000!
40 DIM M(12000): REM MIN PRODUCT-SUM FOR EACH K
50 PRINT "FINDING MINIMAL PRODUCT-SUM NUMBERS"
60 PRINT "FOR K = 2 TO ";KL
70 PRINT
80 REM INITIALIZE ARRAY
90 FOR I = 0 TO KL
100 M(I) = 0
110 NEXT I
120 REM START FACTORIZATION SEARCH
130 GOSUB 1000
140 REM COUNT SOLUTIONS FOUND
150 FC = 0
160 FOR K = 2 TO KL
170 IF M(K) > 0 THEN FC = FC + 1
180 NEXT K
190 PRINT "FOUND SOLUTIONS FOR ";FC;" VALUES"
200 PRINT
210 REM SHOW EXAMPLES
220 PRINT "EXAMPLES:"
230 FOR I = 1 TO 10
240 K = I + 1
250 IF K <= KL AND M(K) > 0 THEN PRINT "K=";K;": ";M(K)
260 NEXT I
270 PRINT
280 REM FIND UNIQUE VALUES AND SUM
290 DIM V(12000): REM STORE UNIQUE VALUES
300 VC = 0: REM COUNT OF UNIQUE VALUES
310 FOR K = 2 TO KL
320 IF M(K) = 0 THEN GOTO 420
330 REM CHECK IF VALUE ALREADY IN V
340 FD = 0
350 FOR J = 1 TO VC
360 IF V(J) = M(K) THEN FD = 1: GOTO 390
370 NEXT J
390 IF FD = 0 THEN VC = VC + 1: V(VC) = M(K)
420 NEXT K
430 REM SUM UNIQUE VALUES
440 SM = 0
450 FOR I = 1 TO VC
460 SM = SM + V(I)
470 NEXT I
480 PRINT "UNIQUE VALUES: ";VC
490 PRINT "SUM: ";SM
500 END
1000 REM FACTORIZATION SEARCH ROUTINE
1010 REM ITERATIVE VERSION - RECURSION TOO LIMITED
1020 DIM S(100,5): REM STACK: PROD,SUM,NFAC,MINFAC,DEPTH
1030 SP = 1: REM STACK POINTER
1040 S(1,1) = 1: REM PRODUCT
1050 S(1,2) = 0: REM SUM
1060 S(1,3) = 0: REM NUM FACTORS
1070 S(1,4) = 2: REM MIN FACTOR
1080 S(1,5) = 0: REM DEPTH
1090 REM PROCESS STACK
1100 IF SP = 0 THEN RETURN
1110 P = S(SP,1): REM PRODUCT
1120 SU = S(SP,2): REM SUM
1130 NF = S(SP,3): REM NUM FACTORS
1140 MF = S(SP,4): REM MIN FACTOR
1150 SP = SP - 1
1160 REM CALCULATE K VALUE
1170 K = NF + P - SU
1180 IF K >= 2 AND K <= KL THEN IF M(K) = 0 OR P < M(K) THEN M(K) = P
1190 REM TRY ADDING FACTORS
1200 FOR F = MF TO 2 * KL
1210 NP = P * F
1220 IF NP > 2 * KL THEN GOTO 1270
1230 IF SP >= 100 THEN GOTO 1270: REM STACK FULL
1240 SP = SP + 1
1250 S(SP,1) = NP: S(SP,2) = SU + F: S(SP,3) = NF + 1: S(SP,4) = MF
1260 NEXT F
1270 GOTO 1100