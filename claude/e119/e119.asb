10 REM DIGIT SUM POWER SEQUENCE
20 REM FIND a(30)
30 DIM SEQ(100): REM SEQUENCE ARRAY
40 DIM PWR(100): REM CORRESPONDING POWERS
50 NS = 0: REM NUMBER IN SEQUENCE
60 REM SEARCH THROUGH POWERS AND SUMS
70 FOR P = 2 TO 15
80 FOR S = 1 TO 100
90 GOSUB 1000: REM CALCULATE S^P
100 IF OV = 1 THEN 180
110 IF R > 999999999 THEN 180
120 N = R: GOSUB 2000: REM GET DIGIT SUM
130 IF DS <> S THEN 180
140 REM FOUND A MATCH - CHECK IF NEW
150 FOR I = 1 TO NS
160 IF SEQ(I) = R THEN 180
170 NEXT I
175 REM ADD TO SEQUENCE
176 NS = NS + 1
177 SEQ(NS) = R
178 PWR(NS) = P
180 NEXT S
190 NEXT P
200 REM SORT SEQUENCE
210 GOSUB 3000
220 REM DISPLAY RESULTS
230 PRINT "FOUND "; NS; " NUMBERS"
240 PRINT
250 FOR I = 1 TO NS
260 IF I > 35 THEN 290
270 PRINT "A("; I; ") = "; SEQ(I); " = "; : GOSUB 4000
280 NEXT I
290 PRINT
300 IF NS >= 30 THEN PRINT "A(30) = "; SEQ(30)
310 IF NS < 30 THEN PRINT "ONLY FOUND "; NS; " NUMBERS"
320 END
1000 REM CALCULATE S^P WITH OVERFLOW CHECK
1010 REM INPUT: S (BASE), P (POWER)
1020 REM OUTPUT: R (RESULT), OV (OVERFLOW FLAG)
1030 R = 1
1040 OV = 0
1050 FOR J = 1 TO P
1060 R = R * S
1070 IF R > 1E+09 THEN OV = 1: RETURN
1080 NEXT J
1090 RETURN
2000 REM CALCULATE DIGIT SUM
2010 REM INPUT: N
2020 REM OUTPUT: DS
2030 DS = 0
2040 T = N
2050 IF T < 1 THEN RETURN
2060 DS = DS + (T - INT(T / 10) * 10)
2070 T = INT(T / 10)
2080 GOTO 2050
3000 REM BUBBLE SORT SEQUENCE
3010 FOR I = 1 TO NS - 1
3020 FOR J = I + 1 TO NS
3030 IF SEQ(I) <= SEQ(J) THEN 3070
3040 T = SEQ(I): SEQ(I) = SEQ(J): SEQ(J) = T
3050 T = PWR(I): PWR(I) = PWR(J): PWR(J) = T
3070 NEXT J
3080 NEXT I
3090 RETURN
4000 REM PRINT NUMBER WITH ITS POWER
4010 REM FIND WHICH POWER WORKS FOR SEQ(I)
4020 N = SEQ(I): GOSUB 2000
4030 FOR PP = 2 TO 15
4040 S = DS: P = PP: GOSUB 1000
4050 IF R = SEQ(I) THEN PRINT DS; "^"; PP: RETURN
4060 NEXT PP
4070 PRINT "?"
4080 RETURN