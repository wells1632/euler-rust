10 REM FIND PERIMETER WITH MAX RIGHT TRIANGLE SOLUTIONS
20 DIM PE(1000): DIM SO(1000, 20, 3): DIM CT(1000)
30 REM INITIALIZE ARRAYS
40 FOR I = 1 TO 1000: PE(I) = 0: CT(I) = 0: NEXT I
50 REM GENERATE PYTHAGOREAN TRIPLES
60 FOR M = 2 TO 31
70   FOR N = 1 TO M - 1
80     IF (M - N) - 2 * INT((M - N) / 2) = 1 THEN GOSUB 300
90   NEXT N
100 NEXT M
110 REM FIND MAX SOLUTIONS
120 MX = 0: MP = 0
130 FOR I = 1 TO 999
140   IF CT(I) > MX THEN MX = CT(I): MP = I
150 NEXT I
160 PRINT "PERIMETER WITH MAX SOLUTIONS: "; MP
170 PRINT "NUMBER OF SOLUTIONS: "; MX
180 PRINT "SOLUTIONS:"
190 FOR I = 1 TO MX
200   A = SO(MP, I, 1): B = SO(MP, I, 2): C = SO(MP, I, 3)
210   PRINT "  "; I; ": ("; A; ", "; B; ", "; C; ")"
220 NEXT I
230 END
300 REM CHECK GCD AND GENERATE TRIPLES
310 GOSUB 500: REM GCD(M,N)
320 IF GC <> 1 THEN RETURN
330 A = M * M - N * N: B = 2 * M * N: C = M * M + N * N
340 K = 1
350 PR = K * (A + B + C)
360 IF PR >= 1000 THEN RETURN
370 SA = K * A: SB = K * B: SC = K * C
380 REM SORT TRIANGLE SIDES
390 IF SA > SB THEN T = SA: SA = SB: SB = T
400 IF SB > SC THEN T = SB: SB = SC: SC = T
410 IF SA > SB THEN T = SA: SA = SB: SB = T
420 REM STORE SOLUTION
430 CT(PR) = CT(PR) + 1
440 SO(PR, CT(PR), 1) = SA
450 SO(PR, CT(PR), 2) = SB
460 SO(PR, CT(PR), 3) = SC
470 K = K + 1: GOTO 350
500 REM GCD FUNCTION
510 GA = M: GB = N
520 IF GB = 0 THEN GC = GA: RETURN
530 GT = GB: GB = GA - INT(GA / GB) * GB: GA = GT: GOTO 520
