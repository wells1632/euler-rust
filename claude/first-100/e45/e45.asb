10 REM FIND TRIANGLE, PENTAGONAL, AND HEXAGONAL NUMBERS
20 PRINT "FINDING NUMBERS THAT ARE TRIANGLE, PENTAGONAL, AND HEXAGONAL..."
30 CT = 0: N = 1
40 REM CALCULATE HEXAGONAL NUMBER
50 HX = N * (2 * N - 1)
60 REM CHECK IF TRIANGLE
70 X = HX: GOSUB 200
80 IF TR = 0 THEN GOTO 160
90 REM CHECK IF PENTAGONAL
100 X = HX: GOSUB 300
110 IF PE = 0 THEN GOTO 160
120 REM FOUND A MATCH
130 CT = CT + 1
140 PRINT "FOUND #"; CT; ": "; HX
150 PRINT "  HEXAGONAL H"; N; " = "; HX
160 N = N + 1
170 IF CT < 3 AND N <= 100000 THEN GOTO 40
180 PRINT "SEARCH COMPLETE. FOUND "; CT; " NUMBERS."
190 END
200 REM CHECK IF X IS TRIANGLE
210 TR = 0: DC = 1 + 8 * X
220 IF DC < 0 THEN RETURN
230 SQ = INT(SQR(DC) + 0.5)
240 IF SQ * SQ <> DC THEN RETURN
250 IF SQ < 1 THEN RETURN
260 IF (SQ - 1) - 2 * INT((SQ - 1) / 2) = 0 THEN TR = 1
270 RETURN
300 REM CHECK IF X IS PENTAGONAL
310 PE = 0: DC = 1 + 24 * X
320 IF DC < 0 THEN RETURN
330 SQ = INT(SQR(DC) + 0.5)
340 IF SQ * SQ <> DC THEN RETURN
350 IF SQ < 1 THEN RETURN
360 IF (1 + SQ) - 6 * INT((1 + SQ) / 6) = 0 THEN PE = 1
370 RETURN