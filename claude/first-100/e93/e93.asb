10  REM DIGIT SET OPTIMIZER
20  REM FIND BEST 4 DIGITS FOR CONSECUTIVE INTEGERS
30  DIM R(10000): REM REACHABLE NUMBERS
40  DIM D(3): REM CURRENT DIGITS
50  DIM P(3): REM PERMUTATION
60  DIM BD(3): REM BEST DIGITS
70  BN = 0: REM BEST N VALUE
80  PRINT "SEARCHING FOR OPTIMAL DIGIT SET..."
90  PRINT
100 REM TRY ALL COMBINATIONS A<B<C<D
110 FOR A = 0 TO 9
120 FOR B = A + 1 TO 9
130 FOR C = B + 1 TO 9
140 FOR D = C + 1 TO 9
150 D(0) = A:D(1) = B:D(2) = C:D(3) = D
160 GOSUB 1000: REM FIND REACHABLE
170 GOSUB 2000: REM FIND CONSECUTIVE
180 IF N <= BN THEN 210
190 BN = N:BD(0) = A:BD(1) = B:BD(2) = C:BD(3) = D
200 PRINT "NEW BEST: ";A;B;C;D;" -> 1 TO ";N
210 NEXT D
220 NEXT C
230 NEXT B
240 NEXT A
250 PRINT
260 PRINT "================================"
270 PRINT "RESULT:"
280 PRINT "BEST DIGIT SET: ";BD(0);BD(1);BD(2);BD(3)
290 PRINT "CONSECUTIVE: 1 TO ";BN
300 PRINT "ANSWER: ";BD(0);BD(1);BD(2);BD(3)
310 PRINT "================================"
320 END
1000 REM FIND REACHABLE NUMBERS
1010 FOR I = 0 TO 10000:R(I) = 0: NEXT I
1020 REM GENERATE ALL 24 PERMUTATIONS
1030 FOR I1 = 0 TO 3
1040 FOR I2 = 0 TO 3
1050 IF I2 = I1 THEN 1190
1060 FOR I3 = 0 TO 3
1070 IF I3 = I1 OR I3 = I2 THEN 1180
1080 FOR I4 = 0 TO 3
1090 IF I4 = I1 OR I4 = I2 OR I4 = I3 THEN 1170
1100 P(0) = D(I1):P(1) = D(I2)
1110 P(2) = D(I3):P(3) = D(I4)
1120 GOSUB 3000: REM EVALUATE ALL EXPRESSIONS
1130 REM SHOW PROGRESS
1140 IF  INT (I1 * 1000 + I2 * 100 + I3 * 10 + I4) / 100 =  INT ((I1 * 1000 + I2 * 100 + I3 * 10 + I4) / 100) THEN  PRINT ".";
1150 NEXT I4
1160 NEXT I3
1170 NEXT I2
1180 NEXT I1
1190 RETURN
2000 REM FIND LONGEST CONSECUTIVE
2010 N = 1
2020 IF R(N) = 0 THEN 2050
2030 N = N + 1
2040 GOTO 2020
2050 N = N - 1
2060 RETURN
3000 REM EVALUATE ALL EXPRESSIONS
3010 FOR O1 = 1 TO 4: REM + - * /
3020 FOR O2 = 1 TO 4
3030 FOR O3 = 1 TO 4
3040 REM STRUCTURE 1: ((A O1 B) O2 C) O3 D
3050 A = P(0):B = P(1):C = P(2):D = P(3)
3060 GOSUB 4000:R1 = V: IF ER THEN 3090
3070 A = R1:B = C:O = O2: GOSUB 4000:R2 = V: IF ER THEN 3090
3080 A = R2:B = D:O = O3: GOSUB 4000: GOSUB 5000
3090 REM STRUCTURE 2: (A O1 (B O2 C)) O3 D
3100 A = P(1):B = P(2):O = O2: GOSUB 4000:R1 = V: IF ER THEN 3130
3110 A = P(0):B = R1:O = O1: GOSUB 4000:R2 = V: IF ER THEN 3130
3120 A = R2:B = P(3):O = O3: GOSUB 4000: GOSUB 5000
3130 REM STRUCTURE 3: (A O1 B) O2 (C O3 D)
3140 A = P(0):B = P(1):O = O1: GOSUB 4000:R1 = V: IF ER THEN 3170
3150 A = P(2):B = P(3):O = O3: GOSUB 4000:R2 = V: IF ER THEN 3170
3160 A = R1:B = R2:O = O2: GOSUB 4000: GOSUB 5000
3170 REM STRUCTURE 4: A O1 ((B O2 C) O3 D)
3180 A = P(1):B = P(2):O = O2: GOSUB 4000:R1 = V: IF ER THEN 3210
3190 A = R1:B = P(3):O = O3: GOSUB 4000:R2 = V: IF ER THEN 3210
3200 A = P(0):B = R2:O = O1: GOSUB 4000: GOSUB 5000
3210 REM STRUCTURE 5: A O1 (B O2 (C O3 D))
3220 A = P(2):B = P(3):O = O3: GOSUB 4000:R1 = V: IF ER THEN 3250
3230 A = P(1):B = R1:O = O2: GOSUB 4000:R2 = V: IF ER THEN 3250
3240 A = P(0):B = R2:O = O1: GOSUB 4000: GOSUB 5000
3250 NEXT O3
3260 NEXT O2
3270 NEXT O1
3280 RETURN
4000 REM APPLY OPERATION: A OP B -> V
4010 ER = 0
4020 IF O = 1 THEN V = A + B: RETURN
4030 IF O = 2 THEN V = A - B: RETURN
4040 IF O = 3 THEN V = A * B: RETURN
4050 IF O = 4 THEN  GOSUB 4100: RETURN
4060 RETURN
4100 REM DIVISION
4110 IF  ABS (B) < 0.0000001 THEN ER = 1: RETURN
4120 V = A / B
4130 RETURN
5000 REM ADD IF POSITIVE INTEGER
5010 IF ER THEN  RETURN
5020 IF V < = 0 OR V > 10000 THEN  RETURN
5030 IF  ABS (V -  INT (V + 0.5)) > 0.0000001 THEN  RETURN
5040 IV =  INT (V + 0.5)
5050 R(IV) = 1
5060 RETURN